@import models._
@import java.util.UUID
@(currentUser: User, currentUserRights: Authorization.UserRights)(userGroups: List[UserGroup], users: List[User], applications: List[Application])(implicit webJarsUtil: org.webjars.play.WebJarsUtil, flash: Flash, request: RequestHeader)

@display(users: Seq[User], groupId: UUID)(header: Html)(footer: Html) = {
    <div class="group-container mdl-cell mdl-cell--12-col mdl-shadow--2dp mdl-color--white" id="group-@groupId">
        <div>
            <div class="header">@header</div>
        </div>
        <table class="group-table mdl-data-table mdl-js-data-table">
        @for(user <- users) {
            <tr class="no-hover td--clear-border">
              <td class="mdl-data-table__cell--non-numeric @if(user.disabled){ text--strikethrough }"><span class="application__name">@user.name</span><i></i>
                <br><span class="application__subject">@user.qualite</span></td>
              <td class="mdl-data-table__cell--non-numeric @if(user.disabled){ text--strikethrough }">@user.email<br>
              </td>
              <td class="mdl-data-table__cell--non-numeric mdl-data-table__cell--content-size">
                @if(user.groupAdmin) {
                  <span class="tag tag--responsable">Responsable</span>
                }
                @if(user.admin) {
                  <span class="tag tag--admin">Admin</span>
                }
              </td>
              <td class="mdl-data-table__cell--non-numeric mdl-data-table__cell--content-size">
                @if(user.instructor) {
                  <span class="tag tag--instructor">Instructeur</span>
                }
                @if(user.helper) {
                  <span class="tag tag--aidant">Aidant</span>
                }
              </td>
                <td class="mdl-data-table__cell--non-numeric mdl-data-table__cell--content-size">
                    <div id="answers-90500d58-4345-4538-a1d7-ff80e87b5398" class="vertical-align--middle">
                        <i class="material-icons icon--light">chat_bubble</i>
                        <span class="application__anwsers">@applications.count(_.creatorUserId == user.id) demandes</span><br>
                        <i class="material-icons icon--light">question_answer</i>
                        <span class="application__anwsers">@applications.count(_.invitedUsers.contains(user.id)) sollicitations</span>
                    </div>
                </td>
              <td>
              @if(!user.disabled && user.id != currentUser.id) {
                  <a class="remove-link" href="@routes.UserController.removeFromGroup(user.id, groupId)">Supprimer</a>
              }
              </td>
            </tr>
        }
        </table>
    </div>
}


@main(currentUser, currentUserRights)(s"Mes groupes") {
    <link rel="stylesheet" media="screen,print" href='@routes.Assets.versioned("stylesheets/newForm.css")'>
}{
      @for(userGroup <- userGroups.sortBy(_.name)) {
        @defining(users.filter(_.groupIds.contains(userGroup.id))){ groupUsers =>
          @display(groupUsers.filter(_.groupIds.length == 1), userGroup.id){
            @userGroup.name
            <span class="text--font-size-medium">@userGroup.description</span>
          }{
            @if(groupUsers.exists(_.groupIds.length != 1)) {
              Et utilisateurs multigroupes :
              @for(user <- groupUsers.filter(_.groupIds.length != 1)) {
                <a href="@routes.UserController.editUser(user.id)" target="_blank" >@user.name (@user.qualite)</a>
              } <hr>
            }
              @helper.form(routes.UserController.add(userGroup.id), "method" -> "get") {
                @helper.CSRF.formField
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                  <input class="mdl-textfield__input" type="text" pattern="-?[0-9]*(\.[0-9]+)?" id="rows" name="rows" value="1">
                  <label class="mdl-textfield__label" for="rows">Nombre d'utilisateur Ã  ajouter</label>
                  <span class="mdl-textfield__error">Ce n'est pas un nombre</span>
                </div>
                <button class="mdl-button mdl-js-button mdl-button--raised" type="submit">
                  Ajouter des utilisateurs dans le groupe
                </button>
              }
          }
        }
      }
}{
}
